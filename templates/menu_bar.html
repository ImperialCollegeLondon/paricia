{% load static %}
{% load i18n %}
{% load rest_framework %}

<div class="navbar navbar-static-top {% block bootstrap_navbar_variant %}navbar-inverse{% endblock %}" role="navigation"
  aria-label="{% trans 'navbar' %}">
  <div class="container">
    <span>
      {% block branding %}
      <a class='navbar-brand' rel="nofollow" href='/'>
        Paricia
      </a>
      {% endblock %}
    </span>

    <ul class="nav navbar-nav pull-left">

      <!-- Everyone can see the reports page (what data they see, depends on permissions) -->
      <li class="nav-item">
        <a class="dropdown-item" href="/validated/data_report">Reports</a>
      </li>

      <!-- If the user is authenticated, they can access the validation page -->
      <!-- As well as importing data functionality and the (remaining API) -->
      {% if user.is_authenticated %}
      <li class="nav-item">
        <a class="dropdown-item" href="/validated/daily_validation">Validation</a>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarImportingMenuLink" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          Importing<span class="caret"></span></a>
        <ul class="dropdown-menu" aria-labelledby="navbarImportingMenuLink">
          <li><a class="dropdown-item" href="/importing/data_import_temp">Data import (Temporal)</a></li>
          <li><a class="dropdown-item" href="/importing/data_import_full">Data import (Full)</a></li>
        </ul>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarMeasurementMenuLink" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          API<span class="caret"></span></a>
        <ul class="dropdown-menu" aria-labelledby="navbarMeasurementMenuLink">
          <li><a class="dropdown-item" href="api/measurement/measurement">Measurements</a></li>
          <li><a class="dropdown-item" href="api/measurement/report">Reports</a></li>
        </ul>
      </li>
      {% endif %}

    </ul>

    <!-- A separate menu for the user to log in or log out -->
    <ul class="nav navbar-nav pull-right">

      <!-- If the user is staff, we show the link to the admin -->
      {% if user.is_staff %}
      <li class="nav-item">
        <a class="nav-link" href="/admin">Admin site</a>
      </li>
      {% endif %}

      <!-- If the user is authenticated, we greet them and include a logout button -->
      <!-- within a dropdown so it is not clicked by mistake -->
      {% if user.is_authenticated %}
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarAdminMenuLink" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">Welcome, {{user.username}}<span class="caret"></span></a>

        <ul class="dropdown-menu" aria-labelledby="navbarAdminMenuLink">
          <li class="nav-item">
            <form method="post" action="{% url 'logout' %}">
              {% csrf_token %}
              <input class="nav-link" type="submit" value="Logout"
                style="border:none;border-color:transparent;background-color:transparent;" />
            </form>
          </li>
        </ul>
      </li>


      {% else %}
      <!-- Otherwise we just show options to register and login -->
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarManagementMenuLink" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          Login/Register<span class="caret"></span></a>
        <ul class="dropdown-menu" aria-labelledby="navbarManagementMenuLink">
          <li><a class="dropdown-item" href="/management/register">Register</a></li>
          <li><a class="nav-link" href="/api-auth/login">Login</a></li>
        </ul>
      </li>
      {% endif %}

    </ul>
  </div>
</div>